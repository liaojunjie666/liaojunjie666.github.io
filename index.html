<!doctypehtml><html lang=zh-CN><meta charset=UTF-8><meta content=width=device-width name=viewport><meta content=#222 name=theme-color><meta content="Hexo 6.3.0" name=generator><link href=/images/apple-touch-icon-next.png rel=apple-touch-icon sizes=180x180><link href=/images/favicon-32x32-next.png rel=icon sizes=32x32 type=image/png><link href=/images/favicon-16x16-next.png rel=icon sizes=16x16 type=image/png><link color=#222 href=/images/logo.svg rel=mask-icon><link href=/css/main.css rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css integrity=sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8= rel=stylesheet><link crossorigin=anonymous href=https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css integrity=sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE= rel=stylesheet><script class=next-config data-name=main type=application/json>{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src=/js/config.js></script><meta content=今天又是什么也没干的一天 name=description><meta content=website property=og:type><meta content=小廖同学的个人博客 property=og:title><meta content=http://example.com/index.html property=og:url><meta content=小廖同学的个人博客 property=og:site_name><meta content=今天又是什么也没干的一天 property=og:description><meta content=zh_CN property=og:locale><meta content=小廖同学 property=article:author><meta content=summary name=twitter:card><link href=http://example.com/ rel=canonical><script class=next-config data-name=page type=application/json>{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script><script class=next-config data-name=calendar type=application/json>""</script><title>小廖同学的个人博客</title><link href=/css/injector/main.css rel=stylesheet><link as=style href=/css/injector/light.css rel=preload><link as=style href=/css/injector/dark.css rel=preload><noscript><link href=/css/noscript.css rel=stylesheet></noscript><body class=use-motion itemscope itemtype=http://schema.org/WebPage><div class=headband></div><main class=main><div class=column><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=site-brand-container><div class=site-nav-toggle><div aria-label=切换导航栏 class=toggle role=button></div></div><div class=site-meta><a class=brand href=/ rel=start><i class=logo-line></i><h1 class=site-title>小廖同学的个人博客</h1><i class=logo-line></i></a></div><div class=site-nav-right><div class="toggle popup-trigger" aria-label=搜索 role=button></div></div></div></header><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录<li class=sidebar-nav-overview>站点概览</ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop=author itemscope itemtype=http://schema.org/Person><p class=site-author-name itemprop=name>小廖同学<div class=site-description itemprop=description>今天又是什么也没干的一天</div></div><div class="site-state-wrap animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>1</span> <span class=site-state-item-name>日志</span></a></div></nav></div></div></div></div></aside></div><div class="main-inner index posts-expand"><div class=post-block><article class=post-content itemscope itemtype=http://schema.org/Article><link href=http://example.com/2023/06/21/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/ itemprop=mainEntityOfPage><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta content=/images/avatar.gif itemprop=image><meta content=小廖同学 itemprop=name></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta content=小廖同学的个人博客 itemprop=name><meta content=今天又是什么也没干的一天 itemprop=description></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta content="undefined | 小廖同学的个人博客" itemprop=name><meta itemprop=description></span><header class=post-header><h2 itemprop="name headline" class=post-title><a class=post-title-link href=/2023/06/21/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/ itemprop=url>未命名</a></h2><div class=post-meta-container><div class=post-meta><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i> </span><span class=post-meta-item-text>发表于</span> <time itemprop="dateCreated datePublished" title="创建时间：2023-06-21 14:11:26" datetime=2023-06-21T14:11:26+08:00>2023-06-21</time> </span><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar-check"></i> </span><span class=post-meta-item-text>更新于</span> <time title="修改时间：2023-04-06 09:04:32" datetime=2023-04-06T09:04:32+08:00 itemprop=dateModified>2023-04-06</time> </span><span class=post-meta-break></span><span class=post-meta-item title=本文字数><span class=post-meta-item-icon><i class="far fa-file-word"></i> </span><span class=post-meta-item-text>本文字数：</span> <span>1.5k</span> </span><span class=post-meta-item title=阅读时长><span class=post-meta-item-icon><i class="far fa-clock"></i> </span><span class=post-meta-item-text>阅读时长 ≈</span> <span>5 分钟</span></span></div></div></header><div class=post-body itemprop=articleBody><h1 id=1-模式简介><a class=headerlink href=#1-模式简介 title=1.模式简介></a>1.模式简介</h1><blockquote><p>单例模式：限制类实例化次数只能一次，一个类只有一个实例，并提供一个访问它的全局访问点。</blockquote><p>单例模式是创建型设计模式的一种。有一些对象我们往往只需要一个，比如线程池、全局缓存、浏览器中的window对象等。<h1 id=2-模式特点><a class=headerlink href=#2-模式特点 title=2.模式特点></a>2.模式特点</h1><ol><li>类只有一个实例。<li>全局可访问该实例。<li>自行实例化（主动实例化）<li>可推迟初始化，即延迟执行（与静态类/对象的区别）</ol><p>JavaScript 是一门非正规面向对象的语言，ES6中class定义的类也是对象。单例模式中要求一个<code>唯一</code> 和<code>全局访问</code> 的对象，在JavaScript中类似全局对象，刚好满足单例模式的两个特点：<code>唯一</code> 和<code>可全局访问</code> 。虽然它不是正规的单例模式，但不可否认确实具备类单例模式的特点。<figure class="highlight javascript"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre><td class=code><pre><span class=line><span class=comment>//全局对象</span></span><br><span class=line><span class=keyword>const</span> globalObj = {};</span><br></pre></table></figure><h2 id=2-1-使用全局变量会有以下问题><a title="2.1 使用全局变量会有以下问题" class=headerlink href=#2-1-使用全局变量会有以下问题></a>2.1 使用全局变量会有以下问题</h2><ol><li>命名空间污染(变量名冲突)<li>维护时不方便管控（容易不小心覆盖）</ol><h2 id=2-2-全局变量问题折中的应对方案><a title="2.2 全局变量问题折中的应对方案" class=headerlink href=#2-2-全局变量问题折中的应对方案></a>2.2 全局变量问题折中的应对方案</h2><ol><li>使用命名空间<li>闭包封装私有变量（利用函数作用域）<li>ES6的 const/symbol</ol><p>虽然全局变量可以实现单例，但因其自身的问题，不建议在实际项目中将其作为单例模式的应用，特别是中大型项目的应用中，全局变量的维护该是考虑的成本。<h1 id=3-模式的实现><a class=headerlink href=#3-模式的实现 title=3.模式的实现></a>3.模式的实现</h1><blockquote><p>实现方式：使用一个变量存储类实例对象（值初始为 <code>null/undefined</code> ）。进行类实例化时，判断类实例对象是否存在，存在则返回该实例，不存在则创建类实例后返回。多次调用类生成实例方法，返回同一个实例对象。</blockquote><h2 id=3-1-“简单版”单例模式><a title="3.1  “简单版”单例模式" class=headerlink href=#3-1-“简单版”单例模式></a>3.1 “简单版”单例模式</h2><figure class="highlight javascript"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br></pre><td class=code><pre><span class=line><span class=keyword>const</span> <span class="title class_">Singleton</span> = <span class=keyword>function</span> (<span class=params>name</span>) {</span><br><span class=line>    <span class="variable language_">this</span>.<span class=property>name</span> = name;</span><br><span class=line>    <span class="variable language_">this</span>.<span class=property>instance</span> = <span class=literal>null</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class="title class_">Singleton</span>.<span class=property><span class=keyword>prototype</span></span>.<span class=property>getName</span> = <span class=keyword>function</span> (<span class=params></span>) {</span><br><span class=line>    <span class=keyword>return</span> <span class="variable language_">this</span>.<span class=property>name</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class="title class_">Singleton</span>.<span class=property>getInstance</span> = <span class=keyword>function</span> (<span class=params>name</span>) {</span><br><span class=line>    <span class=keyword>if</span> (<span class="variable language_">this</span>.<span class=property>instance</span>) {</span><br><span class=line>        <span class=keyword>return</span> <span class="variable language_">this</span>.<span class=property>instance</span>;</span><br><span class=line>    }</span><br><span class=line>    <span class=keyword>return</span> <span class="variable language_">this</span>.<span class=property>instance</span> = <span class=keyword>new</span> <span class="title class_">Singleton</span>(name);</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>const</span> <span class="title class_">Winner</span> = <span class="title class_">Singleton</span>.<span class="title function_">getInstance</span>(<span class=string>'Winner'</span>);</span><br><span class=line><span class=keyword>const</span> <span class="title class_">Looser</span> = <span class="title class_">Singleton</span>.<span class="title function_">getInstance</span>(<span class=string>'Looser'</span>);</span><br><span class=line> </span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span> === <span class="title class_">Looser</span>); <span class=comment>//true</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span>.<span class="title function_">getName</span>()); <span class=comment>//Winner</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Looser</span>.<span class="title function_">getName</span>()); <span class=comment>//Winner</span></span><br></pre></table></figure><p>代码中定义了一个 <code>Singleton</code> 函数，函数在 JavaScript 中是“一等公民“，可以为其定义属性方法。因此我们可以在函数 <code>Singleton</code> 中定义一个 <code>getInstance()</code> 方法来管控单例，并创建返回类实例对象，而不是通过传统的 <code>new</code> 操作符来创建类实例对象。<p><code>this.instance</code> 存储创建的实例对象，每次接收到创建实例对象时，判断 <code>this.instance</code> 是否有实例对象，有则返回，没有则创建并更新 <code>this.instance</code> 值，因此无论调用多少次 <code>getInstance()</code>，最终都只会返回同一个 <code>Singleton</code> 类实例对象。<p><strong>存在问题：</strong><ol><li>不够“透明”，无法使用 <code>new</code> 来进行类实例化，使用<code>new</code>后就不是单例了，需约束该类实例化的调用方式： <code>Singleton.getInstance(...)</code>;<li>管理单例的操作，与对象创建的操作，功能代码耦合在一起，不符合 “单一职责原则”</ol><h2 id=3-2-”透明版“单例模式><a title="3.2  ”透明版“单例模式" class=headerlink href=#3-2-”透明版“单例模式></a>3.2 ”透明版“单例模式</h2><p>实现 “透明版” 单例模式，意图解决：统一使用 <code>new</code> 操作符来获取单例对象， 而不是 <code>Singleton.getInstance(...)</code>。<figure class="highlight javascript"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br></pre><td class=code><pre><span class=line><span class=keyword>const</span> <span class="title class_">CreateSingleton</span> = (<span class=keyword>function</span> (<span class=params></span>) {</span><br><span class=line>    <span class=keyword>let</span> instance;</span><br><span class=line>    <span class=keyword>return</span> <span class=keyword>function</span> (<span class=params>name</span>) {</span><br><span class=line>        <span class=keyword>if</span> (instance) {</span><br><span class=line>            <span class=keyword>return</span> instance;</span><br><span class=line>        }</span><br><span class=line>        <span class="variable language_">this</span>.<span class=property>name</span> = name;</span><br><span class=line>        <span class=keyword>return</span> instance = <span class="variable language_">this</span>;</span><br><span class=line>    }</span><br><span class=line>})();</span><br><span class=line></span><br><span class=line><span class="title class_">CreateSingleton</span>.<span class=property><span class=keyword>prototype</span></span>.<span class=property>getName</span> = <span class=keyword>function</span> (<span class=params></span>) {</span><br><span class=line>    <span class=keyword>return</span> <span class="variable language_">this</span>.<span class=property>name</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>const</span> <span class="title class_">Winner</span> = <span class=keyword>new</span> <span class="title class_">CreateSingleton</span>(<span class=string>'Winner'</span>);</span><br><span class=line><span class=keyword>const</span> <span class="title class_">Looser</span> = <span class=keyword>new</span> <span class="title class_">CreateSingleton</span>(<span class=string>'Looser'</span>);</span><br><span class=line>  </span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span> === <span class="title class_">Looser</span>); <span class=comment>//true</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span>.<span class="title function_">getName</span>());  <span class=comment>//Winner</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Looser</span>.<span class="title function_">getName</span>());  <span class=comment>//Winner</span></span><br></pre></table></figure><p>“透明版”单例模式解决了不够“透明”的问题，我们又可以使用 <code>new</code> 操作符来创建实例对象。<h2 id=3-3-“代理版”单例模式><a title="3.3  “代理版”单例模式" class=headerlink href=#3-3-“代理版”单例模式></a>3.3 “代理版”单例模式</h2><p>通过“代理”的形式，意图解决：将管理单例操作，与对象创建操作进行拆分，实现更小的粒度划分，符合“单一职责原则”。<figure class="highlight javascript"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br></pre><td class=code><pre><span class=line><span class=keyword>const</span> <span class="title class_">ProxyCreateSingleton</span> = (<span class=keyword>function</span> (<span class=params></span>) {</span><br><span class=line>    <span class=keyword>let</span> instance;</span><br><span class=line>    <span class=keyword>return</span> <span class=keyword>function</span> (<span class=params>name</span>) {</span><br><span class=line>        <span class=keyword>if</span> (instance) {</span><br><span class=line>            <span class=keyword>return</span> instance;</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> instance = <span class=keyword>new</span> <span class="title class_">Singleton</span>(name);</span><br><span class=line>    }</span><br><span class=line>})();</span><br><span class=line></span><br><span class=line><span class=keyword>const</span> <span class="title class_">Singleton</span> = <span class=keyword>function</span> (<span class=params>name</span>) {</span><br><span class=line>    <span class="variable language_">this</span>.<span class=property>name</span> = name;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class="title class_">Singleton</span>.<span class=property><span class=keyword>prototype</span></span>.<span class=property>getName</span> = <span class=keyword>function</span> (<span class=params></span>) {</span><br><span class=line>    <span class=keyword>return</span> <span class="variable language_">this</span>.<span class=property>name</span>;</span><br><span class=line>}</span><br><span class=line></span><br><span class=line><span class=keyword>const</span> <span class="title class_">Winner</span> = <span class=keyword>new</span> <span class="title class_">ProxyCreateSingleton</span>(<span class=string>'Winner'</span>);</span><br><span class=line><span class=keyword>const</span> <span class="title class_">Looser</span> = <span class=keyword>new</span> <span class="title class_">ProxyCreateSingleton</span>(<span class=string>'Looser'</span>);</span><br><span class=line></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span> === <span class="title class_">Looser</span>); <span class=comment>//true</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span>.<span class="title function_">getName</span>());  <span class=comment>//Winner</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Looser</span>.<span class="title function_">getName</span>());  <span class=comment>//Winner</span></span><br></pre></table></figure><h2 id=3-4-惰性单例><a title="3.4 惰性单例" class=headerlink href=#3-4-惰性单例></a>3.4 惰性单例</h2><figure class="highlight javascript"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br></pre><td class=code><pre><span class=line><span class=keyword>const</span> <span class="title class_">LazySingleton</span> = (<span class=keyword>function</span> (<span class=params></span>) {</span><br><span class=line>    <span class=keyword>let</span> instance = <span class=literal>null</span>;</span><br><span class=line>    <span class=keyword>function</span> <span class="title function_">Singleton</span>(<span class=params>name</span>) {</span><br><span class=line>        <span class="variable language_">this</span>.<span class=property>name</span> = name;</span><br><span class=line>        <span class="variable language_">this</span>.<span class=property>getName</span> = <span class=keyword>function</span> (<span class=params></span>) {</span><br><span class=line>            <span class=keyword>return</span> <span class="variable language_">this</span>.<span class=property>name</span>;</span><br><span class=line>        }</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>return</span> <span class=keyword>function</span> (<span class=params>name</span>) {</span><br><span class=line>        <span class=keyword>if</span> (!instance) {</span><br><span class=line>            instance = <span class=keyword>new</span> <span class="title class_">Singleton</span>(name);</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> instance;</span><br><span class=line></span><br><span class=line>    }</span><br><span class=line>})()</span><br><span class=line></span><br><span class=line><span class=keyword>const</span> <span class="title class_">Winner</span> = <span class=keyword>new</span> <span class="title class_">LazySingleton</span>(<span class=string>'Winner'</span>);</span><br><span class=line><span class=keyword>const</span> <span class="title class_">Looser</span> = <span class=keyword>new</span> <span class="title class_">LazySingleton</span>(<span class=string>'Looser'</span>);</span><br><span class=line></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span> === <span class="title class_">Looser</span>); <span class=comment>//true</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span>.<span class="title function_">getName</span>());  <span class=comment>//Winner</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Looser</span>.<span class="title function_">getName</span>());  <span class=comment>//Winner</span></span><br></pre></table></figure><p>这就是惰性单例的应用，不在js加载时就进行实例化创建， 而是在需要的时候再进行单例的创建。 如果再次调用， 那么返回的永远是第一次实例化后的实例对象。<h2 id=3-5-ES6中创建单例模式><a title="3.5 ES6中创建单例模式" class=headerlink href=#3-5-ES6中创建单例模式></a>3.5 ES6中创建单例模式</h2><p>ES6中创建对象时引入了<code>class</code>和<code>constructor</code>用来创建对象。提供了为<code>class</code>提供了<code>static</code>关键字定义静态方法， 我们可以将<code>constructor</code>中判断是否实例化的逻辑放入一个静态方法<code>getInstance</code>中，调用该静态方法获取实例， <code>constructor</code>中只包需含实例化所需的代码，这样能增强代码的可读性、结构更加优化。<figure class="highlight javascript"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br></pre><td class=code><pre><span class=line><span class=keyword>class</span> <span class="title class_">Singleton</span> {</span><br><span class=line></span><br><span class=line>    <span class="title function_">constructor</span>(<span class=params>name</span>) {</span><br><span class=line>        <span class="variable language_">this</span>.<span class=property>name</span> = name;</span><br><span class=line>    }</span><br><span class=line>    </span><br><span class=line>    <span class="title function_">getName</span>(<span class=params></span>) {</span><br><span class=line>        <span class=keyword>return</span> <span class="variable language_">this</span>.<span class=property>name</span>;</span><br><span class=line>    }</span><br><span class=line></span><br><span class=line>    <span class=keyword>static</span> <span class="title function_">getInstance</span>(<span class=params>name</span>) {</span><br><span class=line>        <span class=keyword>if</span> (!<span class="variable language_">this</span>.<span class=property>instance</span>) {</span><br><span class=line>            <span class="variable language_">this</span>.<span class=property>instance</span> = <span class=keyword>new</span> <span class="title class_">Singleton</span>(name);</span><br><span class=line>        }</span><br><span class=line>        <span class=keyword>return</span> <span class="variable language_">this</span>.<span class=property>instance</span>;</span><br><span class=line>    }</span><br><span class=line>}</span><br><span class=line> </span><br><span class=line><span class="title class_">Winner</span> = <span class="title class_">Singleton</span>.<span class="title function_">getInstance</span>(<span class=string>'Winner'</span>);</span><br><span class=line><span class="title class_">Looser</span> = <span class="title class_">Singleton</span>.<span class="title function_">getInstance</span>(<span class=string>'Looser'</span>);</span><br><span class=line></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span> === <span class="title class_">Looser</span>); <span class=comment>//true</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Winner</span>.<span class="title function_">getName</span>());  <span class=comment>//Winner</span></span><br><span class=line><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Looser</span>.<span class="title function_">getName</span>());  <span class=comment>//Winner</span></span><br></pre></table></figure><h1 id=4-适用场景><a class=headerlink href=#4-适用场景 title=4.适用场景></a>4.适用场景</h1><p><strong>“单例模式的特点，意图解决：维护一个全局实例对象。”</strong><ol><li>引用第三方库（多次引用只会使用一个库引用，如 jQuery）<li>弹窗（登录框，信息提升框）<li>购物车 (一个用户只有一个购物车)<li>全局态管理 store (Vuex / Redux)</ol><p>项目中引入第三方库时，重复多次加载库文件时，全局只会实例化一个库对象，如 <code>jQuery</code>，<code>lodash</code>，<code>moment</code> …, 其实它们的实现理念也是单例模式应用的一种：<figure class="highlight javascript"><table><tbody><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br></pre><td class=code><pre><span class=line><span class=comment>// 引入代码库 libs(库别名）</span></span><br><span class=line><span class=keyword>if</span> (<span class="variable language_">window</span>.<span class=property>libs</span> != <span class=literal>null</span>) {</span><br><span class=line>  <span class=keyword>return</span> <span class="variable language_">window</span>.<span class=property>libs</span>;    <span class=comment>// 直接返回</span></span><br><span class=line>} <span class=keyword>else</span> {</span><br><span class=line>  <span class="variable language_">window</span>.<span class=property>libs</span> = <span class=string>'...'</span>;   <span class=comment>// 初始化</span></span><br><span class=line>}</span><br></pre></table></figure><h1 id=5-优缺点><a class=headerlink href=#5-优缺点 title=5.优缺点></a>5.优缺点</h1><ul><li>优点：适用于单一对象，只生成一个对象实例，避免频繁创建和销毁实例，减少内存占用。<li>缺点：不适用动态扩展对象，或需创建多个相似对象的场景。</ul><p><em>TIPS: 多线程编程语言中，单例模式会涉及同步锁的问题。而 JavaScript 是单线程的编程语言，暂可忽略该问题。</em></div><footer class=post-footer><div class=post-eof></div></footer></article></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>© <span itemprop=copyrightYear>2023</span><span class=with-love><i class="fa fa-heart"></i> </span><span class=author itemprop=copyrightHolder>小廖同学</span></div><div class=wordcount><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-chart-line"></i> </span><span title=站点总字数>2k</span> </span><span class=post-meta-item><span class=post-meta-item-icon><i class="fa fa-coffee"></i> </span><span title=站点阅读时长>5 分钟</span></span></div><div class=powered-by>由 <a rel="noopener external nofollow noreferrer" href=https://hexo.io/ target=_blank>Hexo</a> & <a rel="noopener external nofollow noreferrer" href=https://theme-next.js.org/muse/ target=_blank>NexT.Muse</a> 强力驱动</div><script defer src=/lib/three.js></script></div></footer><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div><div class=sidebar-dimmer></div><div aria-label=返回顶部 class=back-to-top role=button><i class="fa fa-arrow-up fa-lg"></i><span>0%</span></div><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><script crossorigin=anonymous integrity=sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY= src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js></script><script src=/js/comments.js></script><script src=/js/utils.js></script><script src=/js/motion.js></script><script src=/js/schemes/muse.js></script><script src=/js/next-boot.js></script><script class=next-config data-name=exif type=application/json>"{FocalLength}mm f/{FNumber} {ExposureTime}s"</script><script src=https://fastly.jsdelivr.net/npm/exif-js@2/exif.min.js></script><script src=/lib/exif.js></script><div class=moon-menu><div class=moon-menu-items><div class=moon-menu-item id=moon-menu-item-back2bottom><i class="fas fa-chevron-down"></i></div><div class=moon-menu-item id=moon-menu-item-back2top><i class="fas fa-chevron-up"></i></div></div><div class=moon-menu-button><svg class=moon-menu-bg><circle class=moon-menu-cricle cx=50% cy=50% r=44%></circle><circle class=moon-menu-border cx=50% cy=50% r=48%></circle></svg><div class=moon-menu-content><div class=moon-menu-icon><i class="fas fa-ellipsis-v"></i></div><div class=moon-menu-text></div></div></div></div><script src=/js/injector.js></script><script charset=utf-8 src=/js/lazyload-plugin/lazyload.intersectionObserver.min.js></script>